# Інструкція по налаштуванню папок на Dropbox

## Структура папок

### 1. Папка `/Excel_input`
В цю папку необхідно покласти сформований xlsx файл з списком транзакцій.

**Важливо:** В папці має бути тільки 1 файл.
- Старий файл необхідно видалити, а тоді завантажити новий файл
- Назва файлу не принципова, головне щоб була відповідна структура файлу

### 2. Папка `/Invoices`
В цю папку необхідно завантажити файли з інвойсами.

**Особливості:**
- Не важливо яка буде вкладеність папок в межах цієї папки
- Пошук по файлам інвойсів буде робитись починаючи з папки `/Invoices/`
- Можна створювати підпапки для кращої організації

### 3. Папка `/Parsing_excel_results`
В цю папку буде додаватись файл з результатами пошуку по інвойсам.

**Особливості:**
- Історичні дані в цій папці можна буде видалити за потреби
- Перед запуском автоматизації якось додатково чистити чи наповнювати цю папку не потрібно
- Файли створюються з timestamp: `results_YYYY-MM-DD_HHMMSS.xlsx`

### 4. Папка `/Sorted_invoices_{сьогоднішня дата}`
**Перед запуском автоматизації цієї папки не буде!**

В цю папку будуть додаватись відсортовані файли інвойсів по закінченню автоматизації.

## Процес роботи

### Перед запуском автоматизації:

1. **Завантажити xlsx файл** у папку `/Excel_input`
2. **Завантажити відповідні файли інвойсів** в папку `/Invoices`
3. **Запустити автоматизацію**

### По закінченню автоматизації:

4. Ви отримаєте:
   - **xlsx файл з результатами пошуку** в папці `/Parsing_excel_results`
   - **переміщені і відсортовані файли інвойсів** в папці `/Sorted_invoices_{сьогоднішня дата}`
   - **email повідомлення** про успішне завершення автоматизації

## Логіка сортування файлів

Файли інвойсів сортуються відповідно до наступної логіки:

```
/Sorted_invoices_{{ $now.toFormat("yyyy-MM-dd") }}/{{ $json.date }}/{{ $json.accountName }}/{{ $json.fileName }}
```

### Приклад структури:
```
/Sorted_invoices_2025-07-31/
├── 10.2025/
│   ├── ADVZREV/
│   │   ├── FIN-123456.pdf
│   │   └── F2410128.pdf
│   └── ADVZWAL/
│       └── P2410021.pdf
└── 12.2025/
    └── ADVZREV/
        └── FINORG-789012.pdf
```

### Приклад шляху:
```
/Sorted_invoices_2025-07-31/10.2025/ADVZREV/FIN-123456.pdf
```

## Обслуговування

### Після завершення роботи:

5. **Можна видалити папку** `/Sorted_invoices_2025-07-31` щоб вона не займала місце на Dropbox
6. **Важливо почистити корзину** після видалення папки

### Рекомендації:

- Регулярно очищайте папку `/Parsing_excel_results` від старих файлів
- Зберігайте важливі результати в окремій папці перед видаленням
- Моніторте використання місця на Dropbox

## Troubleshooting

### Проблема: "No files found in Excel_input"
- Переконайтеся, що в папці `/Excel_input` є рівно один XLSX файл
- Видаліть старі файли перед завантаженням нового

### Проблема: "No invoices found"
- Перевірте, чи завантажені файли інвойсів в папку `/Invoices`
- Переконайтеся, що назви файлів містять FIN або альтернативні номери

### Проблема: "Files not moved to Sorted_invoices"
- Перевірте, чи існують оригінальні файли в `/Invoices`
- Переконайтеся, що шляхи в `pathDisplay` правильні
- Перевірте налаштування Gmail для email повідомлень

### Проблема: "Dropbox storage full"
- Видаліть старі папки `/Sorted_invoices_*`
- Очистіть корзину
- Видаліть старі файли з `/Parsing_excel_results` 