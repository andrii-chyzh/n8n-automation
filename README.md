# FIN Invoice Checking and Sorting - XLSX Parser –¥–ª—è n8n

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø–∞—Ä—Å–µ—Ä XLSX —Ñ–∞–π–ª—ñ–≤ –∑ –ø–æ—à—É–∫–æ–º —ñ–Ω–≤–æ–π—Å—ñ–≤ –≤ Dropbox, —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è–º —Ç–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è–º –∑–Ω–∞–π–¥–µ–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –¥–ª—è self-hosted n8n.io.

## –û–ø–∏—Å

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –¥–æ–∑–≤–æ–ª—è—î –ø–∞—Ä—Å–∏—Ç–∏ XLSX —Ñ–∞–π–ª–∏, —à—É–∫–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ —ñ–Ω–≤–æ–π—Å–∏ –≤ Dropbox –ø–∞–ø—Ü—ñ `/Invoices`, —Å–æ—Ä—Ç—É–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ–ø—ñ—é–≤–∞—Ç–∏ –∑–Ω–∞–π–¥–µ–Ω—ñ —Ñ–∞–π–ª–∏ —ñ–Ω–≤–æ–π—Å—ñ–≤ —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –ø–∞–ø–∫–∏. –†—ñ—à–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î n8n's Python Code Node (Beta) –¥–ª—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥—É XML —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ XLSX —Ñ–∞–π–ª—ñ–≤.

## –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

- ‚úÖ **–ë–µ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π** - –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è pandas, openpyxl –∞–±–æ —ñ–Ω—à–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö** - –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –ø–µ—Ä—à–∏–π —Ä—è–¥–æ–∫ –∑ –¥–∞–Ω–∏–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
- ‚úÖ **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ shared strings** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—î XLSX shared strings
- ‚úÖ **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–∫–∏–¥–∞—î –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞ –ø–æ—Ä–æ–∂–Ω—ñ —Ä—è–¥–∫–∏
- ‚úÖ **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –±–∞–≥–∞—Ç—å–æ—Ö –∞—Ä–∫—É—à—ñ–≤** - –æ–±—Ä–æ–±–ª—è—î –≤—Å—ñ –≤–∏–¥–∏–º—ñ –∞—Ä–∫—É—à—ñ –≤ —Ñ–∞–π–ª—ñ
- ‚úÖ **–ü–æ—à—É–∫ —ñ–Ω–≤–æ–π—Å—ñ–≤** - —à—É–∫–∞—î FIN —Ç–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ —ñ–Ω–≤–æ–π—Å–∏ –≤ Dropbox
- ‚úÖ **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤** - –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤—É—î —Ç—ñ–ª—å–∫–∏ –∑–Ω–∞–π–¥–µ–Ω—ñ (OK) —ñ–Ω–≤–æ–π—Å–∏
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è** - –ø–µ—Ä–µ–º—ñ—â—É—î –∑–Ω–∞–π–¥–µ–Ω—ñ —Ñ–∞–π–ª–∏ —É —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –ø–∞–ø–∫–∏
- ‚úÖ **–ï–∫—Å–ø–æ—Ä—Ç –≤ Excel** - –∑–±–µ—Ä—ñ–≥–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ XLSX —Ñ–æ—Ä–º–∞—Ç—ñ
- ‚úÖ **–ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å** - –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∑–æ–≤–Ω—ñ—à–Ω—ñ AI —Å–µ—Ä–≤—ñ—Å–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∏—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö

Workflow –æ–±—Ä–æ–±–ª—è—î –¥–≤–∞ —Ç–∏–ø–∏ —ñ–Ω–≤–æ–π—Å—ñ–≤ –æ–∫—Ä–µ–º–æ:
- **FIN —ñ–Ω–≤–æ–π—Å–∏** - –æ—Å–Ω–æ–≤–Ω—ñ –Ω–æ–º–µ—Ä–∏ (FIN-12345, FINORG-67890)
- **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ —ñ–Ω–≤–æ–π—Å–∏ (ALT)** - –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –Ω–æ–º–µ—Ä–∏ (F2410128, P2410021)

–î–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–Ω–∞–π–¥–µ–Ω–æ–≥–æ —ñ–Ω–≤–æ–π—Å—É –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è JSON –æ–±'—î–∫—Ç:

```json
{
  "invoiceName": "F2410128",
  "status": "OK",
  "accountName": "ADVZREV",
  "date": "10.2024",
  "fileName": "03.10.2024 - F2410128.pdf",
  "pathDisplay": "/Invoices/10.2024/ADVZREV/03.10.2024 - F2410128.pdf"
}
```

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ n8n

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —É –≤–∞—Å –∑–∞–ø—É—â–µ–Ω–∏–π self-hosted n8n.io (–≤–µ—Ä—Å—ñ—è 1.103.2 –∞–±–æ –Ω–æ–≤—ñ—à–∞).

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Dropbox

1. –°—Ç–≤–æ—Ä—ñ—Ç—å Dropbox App –≤ [Dropbox Developer Console](https://www.dropbox.com/developers)
2. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ OAuth2 credentials
3. –°—Ç–≤–æ—Ä—ñ—Ç—å –ø–∞–ø–∫–∏:
   - `/Excel_input` - –¥–ª—è –≤—Ö—ñ–¥–Ω–∏—Ö XLSX —Ñ–∞–π–ª—ñ–≤
   - `/Invoices` - –¥–ª—è –ø–æ—à—É–∫—É —ñ–Ω–≤–æ–π—Å—ñ–≤
   - `/Sorted_invoices_YYYY-MM-DD` - –¥–ª—è –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (—Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
   - `/Parsing_excel_results` - –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –ø–∞—Ä—Å–∏–Ω–≥—É

**üìã –î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –ø–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—é –ø–∞–ø–æ–∫:** [DROPBOX-SETUP.md](DROPBOX-SETUP.md)

### 3. –Ü–º–ø–æ—Ä—Ç –≤–æ—Ä–∫—Ñ–ª–æ—É

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ n8n UI
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Import from file"
3. –í–∏–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª `FIN invoice checking and sorting.json`
4. –í–æ—Ä–∫—Ñ–ª–æ—É –±—É–¥–µ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ –∑ –≥–æ—Ç–æ–≤–∏–º Python –∫–æ–¥–æ–º

### 4. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è credentials

–ù–∞–ª–∞—à—Ç—É–π—Ç–µ Dropbox OAuth2 credentials –¥–ª—è –≤—Å—ñ—Ö Dropbox –Ω–æ–¥ —É –≤–æ—Ä–∫—Ñ–ª–æ—É.

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

1. –†–æ–∑–º—ñ—Å—Ç—ñ—Ç—å XLSX —Ñ–∞–π–ª –≤ –ø–∞–ø—Ü—ñ `/Excel_input` –Ω–∞ Dropbox
2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤–æ—Ä–∫—Ñ–ª–æ—É (Manual Trigger)
3. –í–æ—Ä–∫—Ñ–ª–æ—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
   - –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å —Ñ–∞–π–ª –∑ `/Excel_input`
   - –ü–∞—Ä—Å–∏—Ç—å –¥–∞–Ω—ñ –∑ —É—Å—ñ—Ö –∞—Ä–∫—É—à—ñ–≤
   - –®—É–∫–∞—î FIN —Ç–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ —ñ–Ω–≤–æ–π—Å–∏ –≤ `/Invoices`
   - –§—ñ–ª—å—Ç—Ä—É—î —Ç—ñ–ª—å–∫–∏ –∑–Ω–∞–π–¥–µ–Ω—ñ (OK) —ñ–Ω–≤–æ–π—Å–∏
       - –ü–µ—Ä–µ–º—ñ—â—É—î –∑–Ω–∞–π–¥–µ–Ω—ñ —Ñ–∞–π–ª–∏ –≤ `/Sorted_invoices_YYYY-MM-DD/–¥–∞—Ç–∞/—Ä–∞—Ö—É–Ω–æ–∫/`
   - –ï–∫—Å–ø–æ—Ä—Ç—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ Excel —Ñ–∞–π–ª –≤ `/Parsing_excel_results`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ XLSX —Ñ–∞–π–ª—É

–§–∞–π–ª –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏:
- –î–∞–Ω—ñ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ —Ä—è–¥–∫–∞ 6 –∞–±–æ –ø—ñ–∑–Ω—ñ—à–µ (–≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
- –ö–æ–ª–æ–Ω–∫–∏: B (–¥–∞—Ç–∞), D (—ñ–Ω–≤–æ–π—Å), G (—Å—É–º–∞), M (–æ–ø–∏—Å)
- –ú–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –∞—Ä–∫—É—à—ñ–≤ –∑ –æ–¥–Ω–∞–∫–æ–≤–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é

## –ü–æ—à—É–∫ —ñ–Ω–≤–æ–π—Å—ñ–≤

–í–æ—Ä–∫—Ñ–ª–æ—É —à—É–∫–∞—î –¥–≤–∞ —Ç–∏–ø–∏ —ñ–Ω–≤–æ–π—Å—ñ–≤:

### FIN —ñ–Ω–≤–æ–π—Å–∏
- **–§–æ—Ä–º–∞—Ç:** `FIN-12345` –∞–±–æ `FINORG-67890`
- **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –û—Å–Ω–æ–≤–Ω—ñ –Ω–æ–º–µ—Ä–∏ —ñ–Ω–≤–æ–π—Å—ñ–≤, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º—ñ
- **–ü–æ—à—É–∫:** –®—É–∫–∞—î –≤ –Ω–∞–∑–≤–∞—Ö —Ñ–∞–π–ª—ñ–≤ –≤ –ø–∞–ø—Ü—ñ `/Invoices`
- **–ü—Ä–∏–∫–ª–∞–¥–∏:** `FIN-199764`, `FINORG-23016`

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ —ñ–Ω–≤–æ–π—Å–∏ (ALT)
- **–§–æ—Ä–º–∞—Ç:** `F2410128` –∞–±–æ `P2410021` (F/P + 3+ —Ü–∏—Ñ—Ä)
- **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –î–æ–¥–∞—Ç–∫–æ–≤—ñ –Ω–æ–º–µ—Ä–∏ —ñ–Ω–≤–æ–π—Å—ñ–≤, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∫–∞–∑–∞–Ω—ñ –≤ –æ–ø–∏—Å—ñ –∞–±–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—è—Ö
- **–ü–æ—à—É–∫:** –®—É–∫–∞—î –≤ –Ω–∞–∑–≤–∞—Ö —Ñ–∞–π–ª—ñ–≤ –≤ –ø–∞–ø—Ü—ñ `/Invoices`
- **–ü—Ä–∏–∫–ª–∞–¥–∏:** `F24023851`, `F2403024`, `P2410021`
- **–õ–æ–≥—ñ–∫–∞:** –Ø–∫—â–æ –≤ —Ä—è–¥–∫—É XLSX —î –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –Ω–æ–º–µ—Ä (F/P + —Ü–∏—Ñ—Ä–∏), workflow —à—É–∫–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π —Ñ–∞–π–ª –æ–∫—Ä–µ–º–æ –≤—ñ–¥ FIN –Ω–æ–º–µ—Ä–∞

## –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–∫–∏–¥–∞—é—Ç—å—Å—è:
- –ü–æ—Ä–æ–∂–Ω—ñ —Ä—è–¥–∫–∏
- –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ñ
- –†—è–¥–∫–∏ –∑ `item`: "Bank charges", "Tax salary", "Exchange Gain or Loss", "Transfer", "Sales", "Payment of debts to the director", "Advance CIT 2024", "Tax liability"
- **–¢—ñ–ª—å–∫–∏ –∑–Ω–∞–π–¥–µ–Ω—ñ —ñ–Ω–≤–æ–π—Å–∏** - –∑–∞–ø–∏—Å–∏ –∑—ñ —Å—Ç–∞—Ç—É—Å–æ–º "OK" (NOK –∑–∞–ø–∏—Å–∏ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤—É—é—Ç—å—Å—è)

### Rate Limiting:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Split In Batches –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ñ–∞–π–ª—ñ–≤ –≥—Ä—É–ø–∞–º–∏ –ø–æ 10
- –¶–µ –¥–æ–∑–≤–æ–ª—è—î —É–Ω–∏–∫–Ω—É—Ç–∏ –æ–±–º–µ–∂–µ–Ω—å Dropbox API –ø—Ä–∏ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤

–í–æ—Ä–∫—Ñ–ª–æ—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–º—ñ—â—É—î –∑–Ω–∞–π–¥–µ–Ω—ñ —Ñ–∞–π–ª–∏ —ñ–Ω–≤–æ–π—Å—ñ–≤ —É —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –ø–∞–ø–∫–∏:

```
/Sorted_invoices_YYYY-MM-DD/
‚îú‚îÄ‚îÄ 10.2024/
‚îÇ   ‚îú‚îÄ‚îÄ ADVZREV/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 03.10.2024 - F2410128.pdf
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 05.10.2024 - P2410021.pdf
‚îÇ   ‚îî‚îÄ‚îÄ ADVZWAL/
‚îÇ       ‚îî‚îÄ‚îÄ 15.10.2024 - FIN-12345.pdf
‚îî‚îÄ‚îÄ 12.2024/
    ‚îî‚îÄ‚îÄ ADVZREV/
        ‚îî‚îÄ‚îÄ 26.12.2024 - F2412364.pdf
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–æ—Ä–∫—Ñ–ª–æ—É

1. **Manual Trigger** - –∑–∞–ø—É—Å–∫ –≤–æ—Ä–∫—Ñ–ª–æ—É
2. **Get excel file name** - –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ø–∏—Å–∫—É —Ñ–∞–π–ª—ñ–≤ –∑ `/Excel_input`
3. **Download a excel file** - –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è XLSX —Ñ–∞–π–ª—É
4. **Parse XLSX with Python** - –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–∏—Ö
5. **Exclude some Item types** - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –Ω–µ–±–∞–∂–∞–Ω–∏—Ö —Ç–∏–ø—ñ–≤
6. **Check ALT number is not EMPTY** - —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ FIN —Ç–∞ ALT –ø–æ—Ç–æ–∫–∏
7. **Search using FIN/ALT number** - –ø–æ—à—É–∫ —ñ–Ω–≤–æ–π—Å—ñ–≤ –≤ Dropbox
8. **Filter only found ALT invoices** - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Ç—ñ–ª—å–∫–∏ –∑–Ω–∞–π–¥–µ–Ω–∏—Ö ALT —ñ–Ω–≤–æ–π—Å—ñ–≤
9. **Loop Over Items (Split In Batches)** - —Ä–æ–∑–±–∏—Ç—Ç—è –Ω–∞ –≥—Ä—É–ø–∏ –ø–æ 10 —Ñ–∞–π–ª—ñ–≤
10. **Move invoice files to sorted folder** - –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è –∑–Ω–∞–π–¥–µ–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
11. **Merge FIN and ALT data** - –æ–±'—î–¥–Ω–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
12. **Convert data to excel file** - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –≤ XLSX
13. **Upload excel file with results** - –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
14. **Send successful automation email** - email –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è

**üìã –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–æ–∫—É:** [WORKFLOW-STEPS.md](WORKFLOW-STEPS.md)

## –ü—Ä–∏–∫–ª–∞–¥–∏

### –í—Ö—ñ–¥–Ω–∏–π XLSX —Ñ–∞–π–ª
```
Sheet: ADVZREV
Row 67: 10/01/2024 | FINORG-23016|Advertising... | -5000 | Item description
Row 68: 10/02/2024 | F2410128|Another invoice | 15000 | Another item
Row 69: 10/03/2024 | FIN-199764 - Renewal PPC - PPC Project Tools and Soft admin.google.com F2403024 | 25000 | Project Tools
```

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è:**
- –†—è–¥–æ–∫ 67: –¢—ñ–ª—å–∫–∏ FIN –Ω–æ–º–µ—Ä (FINORG-23016)
- –†—è–¥–æ–∫ 68: –¢—ñ–ª—å–∫–∏ ALT –Ω–æ–º–µ—Ä (F2410128)  
- –†—è–¥–æ–∫ 69: FIN –Ω–æ–º–µ—Ä (FIN-199764) + ALT –Ω–æ–º–µ—Ä (F2403024) –≤ –æ–ø–∏—Å—ñ

### –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è
```
/Sorted_invoices_2024-12-31/
‚îú‚îÄ‚îÄ 10.2024/
‚îÇ   ‚îî‚îÄ‚îÄ ADVZREV/
‚îÇ       ‚îî‚îÄ‚îÄ 03.10.2024 - F2410128.pdf  (–∑–Ω–∞–π–¥–µ–Ω–∏–π —Ñ–∞–π–ª)
```

### –í–∏—Ö—ñ–¥–Ω–∏–π Excel —Ñ–∞–π–ª
```
| invoiceName | status | accountName | date | fileName | pathDisplay |
|-------------|--------|-------------|------|----------|-------------|
| F2410128 | OK | ADVZREV | 10.2024 | 03.10.2024 - F2410128.pdf | /Invoices/10.2024/ADVZREV/03.10.2024 - F2410128.pdf |
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "No data rows found"
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º—ñ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª –¥–∞–Ω—ñ –≤ –æ—á—ñ–∫—É–≤–∞–Ω–∏—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –¥–∞–Ω—ñ –Ω–µ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ –ø–µ—Ä—à–∏—Ö 5 —Ä—è–¥–∫—ñ–≤

### –ü—Ä–æ–±–ª–µ–º–∞: "Invalid shared string index"
- –§–∞–π–ª –º–æ–∂–µ –º–∞—Ç–∏ –ø–æ—à–∫–æ–¥–∂–µ–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É shared strings
- –°–ø—Ä–æ–±—É–π—Ç–µ –∑–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª –∑–∞–Ω–æ–≤–æ –≤ Excel

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä–æ–∂–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –Ω–µ —Ñ—ñ–ª—å—Ç—Ä—É—é—Ç—å—Å—è –≤—Å—ñ —Ä—è–¥–∫–∏ —è–∫ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –î–æ–¥–∞–π—Ç–µ `print` statements –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: Dropbox –ø–æ–º–∏–ª–∫–∏
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ OAuth2 credentials
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –ø–∞–ø–∫–∏ `/Excel_input`, `/Invoices`, `/Parsing_excel_results` —ñ—Å–Ω—É—é—Ç—å
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ–∞–π–ª—ñ–≤

### –ü—Ä–æ–±–ª–µ–º–∞: –§–∞–π–ª–∏ –Ω–µ –∫–æ–ø—ñ—é—é—Ç—å—Å—è
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –∑–Ω–∞–π–¥–µ–Ω—ñ —Ñ–∞–π–ª–∏ —ñ—Å–Ω—É—é—Ç—å –≤ `/Invoices`
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å —à–ª—è—Ö—ñ–≤ —É `pathDisplay`

## –õ—ñ—Ü–µ–Ω–∑—ñ—è

MIT License

## –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–î–ª—è –ø–∏—Ç–∞–Ω—å —Ç–∞ –ø—Ä–æ–±–ª–µ–º —Å—Ç–≤–æ—Ä—é–π—Ç–µ issues –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó.
